# NixOS Configuration

### Setup

* Create `./ident.nix` which contains your hostname, see `ident.nix.example` for an example. The hostname is used as an identifier to load the rest of the configuration, ie `./hosts/your-hostname/default.nix`.
* Each user needs a `secrets.nix` file which provides at least a hashed password created with `mkpasswd`. See `./users/secrets.nix.example` for an example. Alternatively you can enable mutable users (`users.mutableUsers = true;` in `./users/default.nix`) and set your password with `passwd`.


### Conecept

The concept behind this configuration is a simple top-down approach. Each machine has a unique configuration folder structure based on hostname, for example `./hosts/nixos-workstation` or `./hosts/nixos-laptop`. Shared configuration is then imported from there. Here's a quick overview:
```
.
├── configuration.nix                 // Inital config, reads ident.nix and loads a config based on hostname
├── guests/default.nix                // Shared configuration for all VM types
│   ├── anbox/default.nix             // Anbox specific configuration
│   └── libvirtd/default.nix          // Shared configuration for all libvirtd guests
│       └── windows/default.nix       // Shared configuration for all Windows guests
│           └── win10-vm/default.nix  // VM-specific configuration for 'win10-vm'
├── hardware-configuration.nix        // Unmanaged autogenerated hardware specific config
├── hosts/default.nix                 // Shared configuration for all hosts
│   ├── nixos-laptop/default.nix      // Machine-specific configuration for 'nixos-laptop'
│   └── nixos-workstation/default.nix // Machine-specific configuration for 'nixos-workstation'
├── ident.nix                         // Unmanaged identity file, contains hostname
├── ident.nix.example                 // Example identity file
└── users/default.nix                 // Shared configuration for all users
    ├── jdf/default.nix               // 'jdf' user configuration
    │   └── secrets.nix               // Unmanaged secrets file, includes hashed password and API keys
    ├── root/default.nix              // root user configuration
    │   └── secrets.nix               // Unmanaged secrets file, includes hashed root password
    └── secrets.nix.example           // Example secrets file
```

# Style Guide

Having a good style keeps your configurations readable and maintainable which is super important for NixOS.

## General

* Sort alphabetically to make locating everything a breeze.
* Packages should be well commented, including descriptions when avalable and categories based on nixpkgs location.
```
        # applications/radio
        aldo # Morse code training program
        unixcw # sound characters as Morse code on the soundcard or console speaker

        # applications/version-management
        gitAndTools.gitFull # Distributed version control system
        mercurialFull # A fast, lightweight SCM system for very large distributed projects

        # applications/video
        streamlink # CLI for extracting streams from various websites to video player of your choosing

        # applications/virtualization
        looking-glass-client # A KVM Frame Relay (KVMFR) implementation
```
* The `nixfmt` package should be used as a guide to proper formating.
* `with` should always be used when appropriate, for example: `hardware.pulseaudio.package = with pkgs; pulseaudioFull;`